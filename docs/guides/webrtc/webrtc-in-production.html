<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="DeepstreamIO RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="DeepstreamIO Atom Feed"><title data-react-helmet="true">WebRTC in production | DeepstreamIO</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://deepstreamIO.github.io/docs/guides/webrtc/webrtc-in-production"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="WebRTC in production | DeepstreamIO"><meta data-react-helmet="true" name="description" content="Learn about the various approaches to video and audio streaming, connection re-establishment, file chunking etc. that are necessary for production ready WebRTC apps"><meta data-react-helmet="true" property="og:description" content="Learn about the various approaches to video and audio streaming, connection re-establishment, file chunking etc. that are necessary for production ready WebRTC apps"><link data-react-helmet="true" rel="icon" href="/img/eltons/elton-hive.svg"><link data-react-helmet="true" rel="canonical" href="https://deepstreamIO.github.io/docs/guides/webrtc/webrtc-in-production"><link data-react-helmet="true" rel="alternate" href="https://deepstreamIO.github.io/docs/guides/webrtc/webrtc-in-production" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://deepstreamIO.github.io/docs/guides/webrtc/webrtc-in-production" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.82963691.css">
<link rel="preload" href="/assets/js/runtime~main.14d91b41.js" as="script">
<link rel="preload" href="/assets/js/main.2e9742fb.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/eltons/elton-hive.svg" alt="DeepstreamIO" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/eltons/elton-hive.svg" alt="DeepstreamIO" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">DeepstreamIO</b></a><a class="navbar__item navbar__link" href="/docs/tutorials/concepts/what-is-deepstream">Tutorials</a><a class="navbar__item navbar__link" href="/docs/docs">Docs</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/guides">Guides</a><a class="navbar__item navbar__link" href="/blog">Blog</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/deepstreamIO" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/docs/tutorials/concepts/what-is-deepstream">tutorials</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/docs">docs</a><button aria-label="Toggle the collapsible sidebar category &#x27;docs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_TwRn" href="/docs/guides">guides</a><button aria-label="Toggle the collapsible sidebar category &#x27;guides&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/guides/example-apps/http-iot-fridge-monitor">example-apps</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/guides/live-progress-bar/intro">live-progress-bar</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/guides/post-it-board/intro">post-it-board</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" tabindex="0" href="/docs/guides/realtime-search/intro">realtime-search</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" tabindex="0" href="/docs/guides/webrtc/webrtc-intro">webrtc</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/webrtc/webrtc-intro">WebRTC: Fundamentals &amp; Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/webrtc/webrtc-datachannels">WebRTC 01: Data Channels</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/webrtc/webrtc-full-mesh">WebRTC 02: Many-To-Many connectivity</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/webrtc/webrtc-audio-video">WebRTC 03:Audio &amp; Video</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/webrtc/webrtc-video-manipulation">WebRTC 04: Video Editing / Canvas Streams</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/webrtc/webrtc-screen-sharing">WebRTC 05: Screen Sharing</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/webrtc/webrtc-file-transfer">WebRTC 06: File Transfer</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/guides/webrtc/webrtc-in-production">WebRTC in production</a></li></ul></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>WebRTC in production</h1></header><p>Time for some bad news. The examples from the previous tutorials probably worked well on your machine. They most likely still worked well when you shared them with a few colleagues within your company. But for scalable, world wide WebRTC usage there are quite a few more obstacles to overcome</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="browser-limitations">Browser Limitations<a class="hash-link" href="#browser-limitations" title="Direct link to heading">â€‹</a></h2><p>WebRTC is <a href="https://caniuse.com/#search=webrtc" target="_blank" rel="noopener noreferrer">supported by latest versions of Chrome, Firefox and IE Edge</a>, but not in Safari or a number of mobile browsers. With most browser-standards that would simply mean falling back to other mechanisms, but with WebRTC this is hardly possible. Older alternatives such as <a href="https://de.wikipedia.org/wiki/Real_Time_Messaging_Protocol" target="_blank" rel="noopener noreferrer">Flash&#x27;s RTMP</a> are unsupported by the exact same browsers that don&#x27;t provide WebRTC either. As a result a number of video-conferencing vendors use WebRTC as default, but continue to offer downloadable clients for cases where its unavailable.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="connectivity">Connectivity<a class="hash-link" href="#connectivity" title="Direct link to heading">â€‹</a></h2><p>One of the main obstacles when it comes to establishing WebRTC connections is a technique called Network Address Translation or NAT for short. NAT is used by routers, internet service providers or larger companies to bundle multiple endpoints behind a single public IP and route traffic to them. This makes it hard for two peers to connect directly to each other. To circumvent that we can use an approach called &quot;Traversal Using Relays around NAT&quot; or TURN for short. Fortunately there&#x27;s a number of <a href="https://gist.github.com/sagivo/3a4b2f2c7ac6e1b5267c2f1f59ac6c6b" target="_blank" rel="noopener noreferrer">publicly accessible STUN and TURN servers</a>. To use a TURN server just specify its URL in the options for the <code>RTCPeerConnection</code> constructor, e.g. <code> { iceServers: [ { url: &#x27;stun:stun.l.google.com:19302&#x27; } ] }</code></p><p>Once your connection is established it will still drop occasionally. That might be due to dodgy network conditions, too many open background tabs or any number of other reasons. That&#x27;s not much of a problem as long as you make sure to keep track of each connection&#x27;s state and reconnect as soon as it drops.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="video-streaming">Video Streaming<a class="hash-link" href="#video-streaming" title="Direct link to heading">â€‹</a></h2><p>If you have ever used a video conferencing service you&#x27;ll know one thing: reliable video and audio streaming is still an unsolved problem. WebRTC is no different. Building a peer-to-peer video conferencing app sounds tempting: There&#x27;s no central server that can go down and no high traffic costs. But it is something that&#x27;s almost never done in production.</p><p>The reasons are manifold. Users have widely differing input and output requirements. Different webcams provide different resolutions, framerates and qualities, which need to be displayed on a myriad of screen and window sizes.</p><p>Bandwith plays an even more important role. A compressed HD stream requires around 5 Mbit/second. In a full mesh P2P video conference with 10 attendees each node would need to send and receive 50 Mbit/second - unachievable with the upload speeds that most ISP&#x27;s provide.</p><p>This means that for almost all WebRTC video streaming apps the &quot;peer&quot; is in fact a piece of server hardware or software, either an MCU or a SFU.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="mcu-or-sfu">MCU or SFU?<a class="hash-link" href="#mcu-or-sfu" title="Direct link to heading">â€‹</a></h2><p>A <a href="https://en.wikipedia.org/wiki/Multipoint_control_unit" target="_blank" rel="noopener noreferrer">MCU (Multipoint Control Unit)</a> is a technology that consumes one or more video-streams, composes them into a single stream and forwards it to many endpoints. It can also provide additional tasks such as video processing, changing resolution on the fly or generating keyframes and deltas for video compression.</p><p>A <a href="https://webrtcglossary.com/sfu/" target="_blank" rel="noopener noreferrer">SFU (Selective Forwarding Unit)</a> offers similar functionality, but forwards the individual streams upon request.</p><p>So what&#x27;s the difference? Imagine your on a conference call with 20 people, all using different webcams and monitors. With a SFU you get 20 pre-processes streams that need handling. A MCU however gives you a single, well orchestratet stream with what you need to actually display on the screen rather than leaving the heavy lifting to the client.</p><p>Sound awesome, right? The truth though is that SFUs are increasingly becoming the standard. MCUs need to decode each video, resize and reformat it and compose a new frame on every update - this is very computation heavy and requires extremely expensive hardware - especially of the advent of HD, 4k and even 8k displays.</p><p>Clients, even browsers have however become fast enough to handle quite a lot of computation - so forwarding streams directly using an SFU is often completely sufficient.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="file-transfers">File Transfers<a class="hash-link" href="#file-transfers" title="Direct link to heading">â€‹</a></h2><p>File transfers can be equally tricky. WebRTC gives developers a choice of ordered and reliable TCP style, unordered or unreliable UDP style communication. To efficiently transfer files it makes sense to use an unordered, yet reliable model and optimise speed on a byte level. This also makes it possible to receive parts of a file from multiple peers at once, speeding up downloads significantly.</p><p>This does however also mean that its up to the implementation to ensure file integrity using checksums. Another hard limitation is the fact that browsers store the incoming file data in memory - which creates a hard limit to the maximum filesize that can be transferred.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="where-to-go-from-here">Where to go from here<a class="hash-link" href="#where-to-go-from-here" title="Direct link to heading">â€‹</a></h2><p>I hope this guide - despite all its warnings and pitfalls - motivated you to give WebRTC a go for your next application. To learn more about WebRTC production usecases, have a look at <a href="https://webrtchacks.com/" target="_blank" rel="noopener noreferrer">WebRTCHacks</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-tags-row row margin-bottom--sm"><div class="col"><b>Tags:</b><ul class="tags_NBRY padding--none margin-left--sm"><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/docs/tags/web-rtc">WebRTC</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/docs/tags/production">production</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/docs/tags/sfu">SFU</a></li><li class="tag_F03v"><a class="tag_WK-t tagRegular_LXbV" href="/docs/tags/chunking">Chunking</a></li></ul></div></div><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/deepstreamIO/deepstreamIO.github.io/docs/20-guides/webrtc/70-webrtc-in-production.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/guides/webrtc/webrtc-file-transfer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">WebRTC 06: File Transfer</div></a></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#browser-limitations" class="table-of-contents__link toc-highlight">Browser Limitations</a></li><li><a href="#connectivity" class="table-of-contents__link toc-highlight">Connectivity</a></li><li><a href="#video-streaming" class="table-of-contents__link toc-highlight">Video Streaming</a></li><li><a href="#mcu-or-sfu" class="table-of-contents__link toc-highlight">MCU or SFU?</a></li><li><a href="#file-transfers" class="table-of-contents__link toc-highlight">File Transfers</a></li><li><a href="#where-to-go-from-here" class="table-of-contents__link toc-highlight">Where to go from here</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Content</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials/install/linux">Install</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/tutorials/concepts/what-is-deepstream">Tutorials</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/docs">Documentation</a></li><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/deepstreamIO/deepstreamIO.github.io/discussions" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items"><li class="footer__item"><a href="https://github.com/deepstreamIO/deepstream.io/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Server changelog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/deepstreamIO/deepstream.io-client-js/blob/master/CHANGELOG.md" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Client changelog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2022 deepstreamHub GmbH and contributors</div></div></div></footer></div>
<script src="/assets/js/runtime~main.14d91b41.js"></script>
<script src="/assets/js/main.2e9742fb.js"></script>
</body>
</html>