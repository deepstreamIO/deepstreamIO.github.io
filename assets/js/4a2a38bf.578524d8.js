"use strict";(self.webpackChunkdeepstream_io_website=self.webpackChunkdeepstream_io_website||[]).push([[5847],{3905:function(e,t,a){a.d(t,{Zo:function(){return d},kt:function(){return m}});var n=a(7294);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function s(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,o=function(e,t){if(null==e)return{};var a,n,o={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(o[a]=e[a]);return o}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(o[a]=e[a])}return o}var l=n.createContext({}),c=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):s(s({},t),e)),a},d=function(e){var t=c(e.components);return n.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},p=n.forwardRef((function(e,t){var a=e.components,o=e.mdxType,r=e.originalType,l=e.parentName,d=i(e,["components","mdxType","originalType","parentName"]),p=c(a),m=o,h=p["".concat(l,".").concat(m)]||p[m]||u[m]||r;return a?n.createElement(h,s(s({ref:t},d),{},{components:a})):n.createElement(h,s({ref:t},d))}));function m(e,t){var a=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var r=a.length,s=new Array(r);s[0]=p;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:o,s[1]=i;for(var c=2;c<r;c++)s[c]=a[c];return n.createElement.apply(null,s)}return n.createElement.apply(null,a)}p.displayName="MDXCreateElement"},2176:function(e,t,a){a.r(t),a.d(t,{frontMatter:function(){return i},contentTitle:function(){return l},metadata:function(){return c},toc:function(){return d},default:function(){return p}});var n=a(7462),o=a(3366),r=(a(7294),a(3905)),s=["components"],i={title:"Storing Data",description:"Find out how deepstream uses cache and storage systems to store your data",redirectFrom:["/docs/tutorials/core/server/storing-data/"]},l=void 0,c={unversionedId:"tutorials/core/datasync/storing-data",id:"tutorials/core/datasync/storing-data",title:"Storing Data",description:"Find out how deepstream uses cache and storage systems to store your data",source:"@site/docs/00-tutorials/20-core/70-datasync/60-storing-data.md",sourceDirName:"00-tutorials/20-core/70-datasync",slug:"/tutorials/core/datasync/storing-data",permalink:"/docs/tutorials/core/datasync/storing-data",editUrl:"https://github.com/deepstreamIO/deepstream.io-website/docs/00-tutorials/20-core/70-datasync/60-storing-data.md",tags:[],version:"current",sidebarPosition:60,frontMatter:{title:"Storing Data",description:"Find out how deepstream uses cache and storage systems to store your data",redirectFrom:["/docs/tutorials/core/server/storing-data/"]},sidebar:"tutorialSidebar",previous:{title:"Handling Data Conflicts",permalink:"/docs/tutorials/core/datasync/handling-data-conflicts"},next:{title:"Listening in deepstream",permalink:"/docs/tutorials/core/listening/index"}},d=[{value:"How deepstream stores data",id:"how-deepstream-stores-data",children:[],level:2},{value:"So why have this distinction between cache and storage at all?",id:"so-why-have-this-distinction-between-cache-and-storage-at-all",children:[],level:2},{value:"Why doesn&#39;t deepstream store data itself?",id:"why-doesnt-deepstream-store-data-itself",children:[],level:2},{value:"Connecting to a cache or database",id:"connecting-to-a-cache-or-database",children:[],level:2},{value:"Choosing a database and cache",id:"choosing-a-database-and-cache",children:[],level:2},{value:"Downloading and installing connectors",id:"downloading-and-installing-connectors",children:[],level:2},{value:"Writing your own connector",id:"writing-your-own-connector",children:[],level:2}],u={toc:d};function p(e){var t=e.components,a=(0,o.Z)(e,s);return(0,r.kt)("wrapper",(0,n.Z)({},u,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"how-deepstream-stores-data"},"How deepstream stores data"),(0,r.kt)("p",null,"As a standalone server, deepstream keeps all its data in internal memory. In a production cluster however, deepstream servers won't hold any data themselves. Instead, data is stored in a combination of storage and cache layers that are accessible to all deepstream nodes within the cluster. This allows the individual servers to remain stateless and go down / fail over without causing any data-loss, but it also allows for the data to be distributed across multiple nodes."),(0,r.kt)("p",null,"deepstream can connect to both a cache and a database at the same time.\nWhenever a value needs to be stored, it is written to the cache in a blocking fashion and simultaneously written to storage in a non-blocking way."),(0,r.kt)("p",null,"Similarly, whenever an entry needs to be retrieved, deepstream looks for it in the cache first and in storage second. If the value can only be found in storage, deepstream will load it into the cache for faster access."),(0,r.kt)("h2",{id:"so-why-have-this-distinction-between-cache-and-storage-at-all"},"So why have this distinction between cache and storage at all?"),(0,r.kt)("p",null,"Because they complement each other quite well!"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Caches need to make relatively small amounts of data accessible at high speeds. They usually achieve this by storing data in memory, rather than on disk (although some, e.g. Redis, can write to disk as well). This means that all data is lost when the process exists. Caches also usually don't offer support for complex queries (although e.g. ",(0,r.kt)("a",{parentName:"p",href:"../../plugins/cache/hazelcast"},"Hazelcast")," has some).")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},"Databases (storage) are slower to read or write to, but offer efficient long-term storage for larger amounts of data and allow for more elaborate ways of querying (e.g. full-text search, SQL joins etc.)"))),(0,r.kt)("h2",{id:"why-doesnt-deepstream-store-data-itself"},"Why doesn't deepstream store data itself?"),(0,r.kt)("p",null,"deepstream is sometimes compared to projects like ",(0,r.kt)("a",{parentName:"p",href:"https://firebase.google.com/"},"Firebase")," (now part of Google Cloud Platform)  - realtime databases that let users create streaming queries."),(0,r.kt)("p",null,"While deepstream is a great fit for similar use-cases, it's conceptually quite different: deepstream's design-philosophy is inspired by the way multiplayer-game servers or financial streaming works, rather than by datastores."),(0,r.kt)("p",null,"It can be used as a blazingly fast standalone server without any data-layer, but can also cater for large-scale collaboration apps with demanding storage requirements when connected to both a cache and a database."),(0,r.kt)("p",null,"Finally, we've taken the lessons learned from fixed stack frameworks like ",(0,r.kt)("a",{parentName:"p",href:"https://www.meteor.com/"},"Meteor")," to heart. deepstream is a fast and versatile realtime server - but it doesn't try to be anything more than that."),(0,r.kt)("p",null,"We believe that web technology is moving away from the monolithic enterprise stacks of the past towards a vibrant ecosystem of highly specialized microservices - and our goal is to make deepstream thrive within this ecosystem by making it usable with as many programming languages, frontend frameworks, databases, caches, loggers, identity management systems or deployment environments possible."),(0,r.kt)("h2",{id:"connecting-to-a-cache-or-database"},"Connecting to a cache or database"),(0,r.kt)("p",null,'deepstream uses different types of "connectors" - plugins that enable it to interface with other systems.'),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Cache connectors"))," are plugins that connect deepstream to an in-memory cache, e.g. Redis, Memcached, IronCache, Hazelcast or Aerospike."),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},(0,r.kt)("em",{parentName:"strong"},"Storage connectors"))," are plugins that connect deepstream to a database, e.g. MongoDB, CouchDB, Cassandra or Amazon's DynamoDB."),(0,r.kt)("h2",{id:"choosing-a-database-and-cache"},"Choosing a database and cache"),(0,r.kt)("p",null,"When it comes to choosing a database and cache, there are a few things to take into account:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Choose systems that scale in the cloud")," deepstream can scale horizontally across many computers or instances in the cloud. But that won't help much if your database or cache doesn't do the same. Fortunately, most popular solutions offer some form of sharding, clustering or cloud-replication, but not all cloud services support that. If you're using AWS for instance and consider ElastiCache with Redis as a caching engine, your deployment is limited to a single machine.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Choose systems that complement each other")," Some caches like Redis store data to disk and can be used without a database. Some systems like Hazelcast or Redis offer both caching and pub/sub messaging, eliminating the need for a separate message-bus. Some in-memory only caches like Memcached are extremely fast, but need to be backed by a database for persistent storage. Some databases offer very fast read performance and a build-in caching layer, so could be used by themselves (make sure to register them as a cache though since otherwise deepstream might fall back to its internal cache and use the potentially stale data within).")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Object/Document/NoSQL databases make more sense than relational ones")," deepstream's data-structures are small, independent chunks of JSON, identified by a unique key that can be organized in collections. This makes them a natural fit for object or document oriented databases like Mongo, Rethink or Couch. deepstream also works with relational databases like MySQL, PostGre or Oracle, but doesn't take advantage of their data-modelling capabilities.")),(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("strong",{parentName:"p"},"Be careful when using external x-as-a-service providers"),"\nIt can be tempting to use a fully managed cache from an infrastructure-as-a-service provider, but be aware if its hosted outside of your datacenter: deepstream constantly interacts with its cache and every millisecond in network latency will slow down your application.\nEqually, a lot of cache / database protocols are designed for use within a trusted environment and therefor unencrypted. If your database lives outside of your network, make sure to use TLS or choose a service that offers a VPN."))),(0,r.kt)("h2",{id:"downloading-and-installing-connectors"},"Downloading and installing connectors"),(0,r.kt)("p",null,"deepstream connectors are available for many popular databases and caches and we're constantly looking to expand the selection. You can find an overview of available connectors on the tutorials section. Connectors can be installed via deepstream's commandline interface, using the ",(0,r.kt)("inlineCode",{parentName:"p"},"cache")," or ",(0,r.kt)("inlineCode",{parentName:"p"},"storage")," keyword, e.g."),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"deepstream install cache redis\ndeepstream install cache memcached\ndeepstream install storage mongodb\ndeepstream install storage rethinkdb\n\n# or on windows using deepstream.exe\ndeepstream.exe install storage rethinkdb\n")),(0,r.kt)("p",null,"Each connector requires specific configuration parameters. These can be configured in deepstream's config.yml file (found either in your deepstream's ",(0,r.kt)("inlineCode",{parentName:"p"},"conf")," directory or on linux in ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/deepstream/"),"). When installing a connector, it usually prints an example of the most common settings."),(0,r.kt)("p",null,"Cache connectors are configured in the config's ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins - cache")," section, database connectors in ",(0,r.kt)("inlineCode",{parentName:"p"},"plugins - storage")),(0,r.kt)("p",null,"If you're using deepstream from Node, it's also possible to download connectors from NPM. All connectors follow the naming convention ",(0,r.kt)("inlineCode",{parentName:"p"},"deepstream.io-type-name"),", e.g. ",(0,r.kt)("inlineCode",{parentName:"p"},"deepstream.io-storage-rethinkdb"),"."),(0,r.kt)("h2",{id:"writing-your-own-connector"},"Writing your own connector"),(0,r.kt)("p",null,"If you can't find a connector for your system of choice, you can also write your own quite easily in C++ with Node bindings or in Node.js. If you're happy with the way your connector turned out, please consider contributing it."),(0,r.kt)("p",null,"For a guide into how to implement your own connection, please refer to the ",(0,r.kt)("a",{parentName:"p",href:"../../custom-plugins/an-overview"},"custom plugin")," guides."))}p.isMDXComponent=!0}}]);