"use strict";(self.webpackChunkdeepstreamio_github_io=self.webpackChunkdeepstreamio_github_io||[]).push([[9245],{4024:(e,n,t)=>{t.r(n),t.d(n,{contentTitle:()=>o,default:()=>d,frontMatter:()=>s,metadata:()=>i,toc:()=>l});var a=t(8168),r=(t(6540),t(5680));const s={title:"Angular"},o=void 0,i={unversionedId:"tutorials/integrations/frontend/angular",id:"tutorials/integrations/frontend/angular",title:"Angular",description:"This tutorial has not been updated",source:"@site/docs/00-tutorials/50-integrations/10-frontend/30-angular.md",sourceDirName:"00-tutorials/50-integrations/10-frontend",slug:"/tutorials/integrations/frontend/angular",permalink:"/docs/tutorials/integrations/frontend/angular",editUrl:"https://github.com/deepstreamIO/deepstreamIO.github.io/docs/00-tutorials/50-integrations/10-frontend/30-angular.md",tags:[],version:"current",sidebarPosition:30,frontMatter:{title:"Angular"},sidebar:"tutorialSidebar",previous:{title:"VueJS",permalink:"/docs/tutorials/integrations/frontend/vuejs"},next:{title:"KnockoutJs",permalink:"/docs/tutorials/integrations/frontend/knockout"}},l=[{value:"1. Setup Angular",id:"1-setup-angular",children:[],level:2},{value:"2. Install deepstream",id:"2-install-deepstream",children:[],level:2},{value:"3. Create deepstream Service (DsService)",id:"3-create-deepstream-service-dsservice",children:[],level:2},{value:"4. Login to deepstream",id:"4-login-to-deepstream",children:[],level:2},{value:"5. Chat Messaging",id:"5-chat-messaging",children:[],level:2},{value:"6. Chat Listing",id:"6-chat-listing",children:[],level:2}],p={toc:l},c="wrapper";function d(e){let{components:n,...s}=e;return(0,r.yg)(c,(0,a.A)({},p,s,{components:n,mdxType:"MDXLayout"}),(0,r.yg)("div",{className:"admonition admonition-caution alert alert--warning"},(0,r.yg)("div",{parentName:"div",className:"admonition-heading"},(0,r.yg)("h5",{parentName:"div"},(0,r.yg)("span",{parentName:"h5",className:"admonition-icon"},(0,r.yg)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,r.yg)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"caution")),(0,r.yg)("div",{parentName:"div",className:"admonition-content"},(0,r.yg)("p",{parentName:"div"},"This tutorial has not been updated"))),(0,r.yg)("p",null,'The "new Angular" popularly known as "Angular", ',(0,r.yg)("a",{parentName:"p",href:"https://toddmotto.com/please-stop-worrying-about-angular-3#real-versioning"},"though a bad name"),", is component architected and follows the W3C component standards thereby forcing us ( for a good reason ) to build apps as reusable UI components/widgets. This means you can't continue to build apps the exact same way you did while using Angular 1.x."),(0,r.yg)("p",null,"You can get started with Angular 2 using the ",(0,r.yg)("a",{parentName:"p",href:"https://angular.io/docs/ts/latest/quickstart.html"},"Quickstart guide")," which is enough knowledge to start using deepstream in Angular. Using deepstream in Angular is what this guide is about."),(0,r.yg)("h2",{id:"1-setup-angular"},"1. Setup Angular"),(0,r.yg)("p",null,"Angular provides a ",(0,r.yg)("a",{parentName:"p",href:"https://github.com/angular/angular-cli"},"CLI tool")," which takes the pain of booting and scaffolding an Angular project by reducing the process to just one command:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"# Creates a new Angular project\nng new deepchat\n")),(0,r.yg)("p",null,"Of course, you would get an error because ",(0,r.yg)("inlineCode",{parentName:"p"},"ng")," is not installed to your PATH but you can do so with ",(0,r.yg)("inlineCode",{parentName:"p"},"npm"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"# Installs the Angular CLI tool\nnpm install -g angular-cli\n")),(0,r.yg)("p",null,"You can run the ",(0,r.yg)("inlineCode",{parentName:"p"},"new")," command again to start a new project. Once that is done, the new project can actually be launched and you can do that using:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"# First, move a step into\n# the project directory\n# if you are not there yet\ncd deepchat\n# Launch app\nng serve\n")),(0,r.yg)("p",null,(0,r.yg)("img",{src:t(9287).A})),(0,r.yg)("h2",{id:"2-install-deepstream"},"2. Install deepstream"),(0,r.yg)("p",null,"deepstream needs to be installed on both the client and server. Angular is a client tool so we are focusing on the client installation but you can follow the steps ",(0,r.yg)("a",{parentName:"p",href:"https://deepstream.io/tutorials/install/linux/"},"here")," to install deepstream on the server."),(0,r.yg)("p",null,"Installing deepstream in Angular projects is quite simple. Angular bundles up scripts using Webpack and splits these bundles in a manner that makes it easier for browsers load them faster. To help Angular with this process, rather than just installing the scripts anywhere, we install with ",(0,r.yg)("inlineCode",{parentName:"p"},"npm")," and load the script as a vendor file."),(0,r.yg)("p",null,"First, install via ",(0,r.yg)("inlineCode",{parentName:"p"},"npm"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"npm install @deepstream/client\n")),(0,r.yg)("p",null,"To tell Angular that the install dependency is a vendor file and should be loaded accordingly, add deepstream script to the ",(0,r.yg)("inlineCode",{parentName:"p"},"scripts")," array in ",(0,r.yg)("inlineCode",{parentName:"p"},"./angular-cli.json"),":"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-json"},'. . .\n"scripts": [\n   "../node_modules/@deepstream/client/dist/deepstream.js"\n ],\n. . .\n')),(0,r.yg)("p",null,"You can see that installation was successful by running the following command in your ",(0,r.yg)("inlineCode",{parentName:"p"},"AppComponent"),"'s constructor:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-javascript"},"export class AppComponent {\n    constructor() {\n      // Logs the deepstream function\n      console.log(deepstream);\n    }\n}\n")),(0,r.yg)("p",null,"Depending on your Typescript configuration, calling ",(0,r.yg)("inlineCode",{parentName:"p"},"deepstream")," from nowhere might throw an error."),(0,r.yg)("h2",{id:"3-create-deepstream-service-dsservice"},"3. Create deepstream Service (DsService)"),(0,r.yg)("p",null,"deepstream will work perfectly fine when used directly in the component but as your project grows large, you might find yourself in the deep mess of violating ",(0,r.yg)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/Don't_repeat_yourself"},"DRY"),". A common pattern in Angular (both 1.x and the newer versions) is to create a service that abstracts a group of tasks so this services can be used and re-used by multiple components if need be."),(0,r.yg)("p",null,"In our case, we need a service to group all our deepstream task and expose methods to our components to interact with:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-javascript"},"// ./src/app/services/ds.service.ts\nimport { Injectable } from '@angular/core';\n\n@Injectable()\nexport class DsService {\n\n    private ds;\n    public dsInstance;\n\n    constructor() {\n       this.ds = this.dsInstance = new DeepstreamClient('localhost:6020');\n    }\n}\n")),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"dsInstance")," is public (though we know the deal with privacy in JavaScript) so you can access all ",(0,r.yg)("inlineCode",{parentName:"p"},"deepstream"),"'s method from it. If that you think this is all you need from such service, fine, but you can also wrap the common methods by creating more members on the service:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-javascript"},"// ./src/app/services/ds.service.ts\nimport { Injectable } from '@angular/core';\n\n@Injectable()\nexport class DsService {\n\n    private ds;\n    public dsInstance;\n\n    constructor() {\n      this.ds = this.dsInstance = new DeepstreamClient('localhost:6020');\n    }\n\n    login (credentials?, loginHandler?) {\n      // {username: 'chris', password:'password'}\n      this.ds.login(credentials, loginHandler);\n    }\n\n    getRecord(name) {\n      return this.ds.record.getRecord(name);\n    }\n\n    getList(name){\n      return this.ds.record.getList(name);\n    }\n}\n")),(0,r.yg)("p",null,"Those are the three methods we need to log in, create or get a record and create or get a list."),(0,r.yg)("h2",{id:"4-login-to-deepstream"},"4. Login to deepstream"),(0,r.yg)("p",null,"Authenticating to deepstream server does not require credentials and for simple stuffs like a demo, you can go ahead and perform and anonymous authentication:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-javascript"},"// ./src/app/app.component.ts\nimport { Component, OnInit } from '@angular/core';\nimport { DsService } from './services/ds.service';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  // ...\n})\nexport class AppComponent implements OnInit{\n  title = 'deepChat';\n  username;\n\n  constructor(\n    private ds: DsService\n  ) {}\n\n  ngOnInit() {\n    // Get username from\n    // window prompt and use 'anonymous' for\n    // null or invalid response\n    const defaultUsername = 'anonymous';\n    const username = window.prompt('Please enter your username', defaultUsername);\n    if (username != null) {\n      this.username = username;\n    } else {\n      this.username = defaultUsername;\n    }\n    // Login without credentials\n    this.ds.login(null, this.loginHandler);\n  }\n\n  loginHandler(success, data) {\n    console.log('logged in', success, data);\n  }\n\n}\n")),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"ngOnInit")," method is a lifecycle method that is called when the component is initialized. This means that when the component is initialized, we try to authenticate deepstream with no credentials. The username is gotten from ",(0,r.yg)("inlineCode",{parentName:"p"},"prompt")," is just used to identify who is who."),(0,r.yg)("h2",{id:"5-chat-messaging"},"5. Chat Messaging"),(0,r.yg)("p",null,"Let's create another method that will be called when the user creates a chat message:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-javascript"},"// ./src/app/app.component.ts\nimport { Component, OnInit } from '@angular/core';\nimport { DsService } from './services/ds.service';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent implements OnInit{\n  title = 'deepChat';\n  username;\n  text;\n  chats;\n\n  constructor(\n    private ds: DsService\n  ) {}\n\n  // . . .\n\n  addChat() {\n\n    const recordName = 'chat/' + this.ds.dsInstance.getUid();\n\n    const chatRecord = this.ds.getRecord(recordName);\n    chatRecord.set({username: this.username, text: this.text});\n    this.text = '';\n    // Update the chats list\n    this.chats.addEntry(recordName);\n  }\n}\n")),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"addChat")," method creates a ",(0,r.yg)("a",{parentName:"p",href:"https://deepstream.io/docs/tutorials/core/datasync/records/"},"record"),", sets a value to the record, clears the text property and updates the deepstream chat list with the record name."),(0,r.yg)("p",null,"The markup for creating messages is quite simple:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-html"},'// ./src/app/app.component.html\n<div class="compose">\n  <input type="text" [(ngModel)]="text">\n  <button (click)="addChat()">Send</button>\n</div>\n')),(0,r.yg)("p",null,"We perform a two-way binding to the input with the ",(0,r.yg)("inlineCode",{parentName:"p"},"text")," property as well as add a click event listener to the send button which calls ",(0,r.yg)("inlineCode",{parentName:"p"},"addChat")," method."),(0,r.yg)("h2",{id:"6-chat-listing"},"6. Chat Listing"),(0,r.yg)("p",null,"The ",(0,r.yg)("inlineCode",{parentName:"p"},"chats")," property, for now, is undefined and is supposed to be a ",(0,r.yg)("a",{parentName:"p",href:"/docs/tutorials/core/datasync/lists/"},"deepstream list")," which will hold the collection of deepstream records."),(0,r.yg)("p",null,"We can create this list when the component is ready, and subscribe to it as well so as to print the ",(0,r.yg)("inlineCode",{parentName:"p"},"chats")," as they come in:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-javascript"},"// ./src/app/app.component.ts\n// ...\n\n@Component(...)\nexport class AppComponent implements OnInit{\n  title = 'deepChat';\n  username;\n  text;\n  chats;\n  chatArray = [];\n\n  constructor(\n    private ds: DsService\n  ) {}\n\n  ngOnInit() {\n    // . . .\n\n    this.chats = this.ds.getList('chats');\n\n    this.chats.on('entry-added', recordName => {\n\n      this.ds.getRecord( recordName ).whenReady( record => {\n\n        record.subscribe( (data) => {\n          if(data.username && data.text) {\n            // Update bindable property\n            this.chatArray.push(data);\n          }\n        }, true );\n\n      });\n    })\n  }\n\n  // . . .\n}\n")),(0,r.yg)("p",null,"What is going is, we created a list that records can be added to as seen in the ",(0,r.yg)("inlineCode",{parentName:"p"},"addChat")," method and then listen to this list for data entry. Once the list is updated, we update the ",(0,r.yg)("inlineCode",{parentName:"p"},"chatArray")," which is the property that we need to iterate on the UI to display the chats as shown below:"),(0,r.yg)("pre",null,(0,r.yg)("code",{parentName:"pre",className:"language-html"},'\x3c!-- ./src/app/app.component.html --\x3e\n<div class="chats">\n      <p *ngFor="let chat of chatArray"><strong>{{chat.username}}: </strong> {{chat.text}}</p>\n    </div>\n')),(0,r.yg)("p",null,(0,r.yg)("img",{src:t(7844).A})))}d.isMDXComponent=!0},5680:(e,n,t)=>{t.d(n,{xA:()=>c,yg:()=>m});var a=t(6540);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function i(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},s=Object.keys(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(a=0;a<s.length;a++)t=s[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=a.createContext({}),p=function(e){var n=a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},c=function(e){var n=p(e.components);return a.createElement(l.Provider,{value:n},e.children)},d="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},g=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,s=e.originalType,l=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),d=p(t),g=r,m=d["".concat(l,".").concat(g)]||d[g]||u[g]||s;return t?a.createElement(m,o(o({ref:n},c),{},{components:t})):a.createElement(m,o({ref:n},c))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var s=t.length,o=new Array(s);o[0]=g;var i={};for(var l in n)hasOwnProperty.call(n,l)&&(i[l]=n[l]);i.originalType=e,i[d]="string"==typeof e?e:r,o[1]=i;for(var p=2;p<s;p++)o[p]=t[p];return a.createElement.apply(null,o)}return a.createElement.apply(null,t)}g.displayName="MDXCreateElement"},7844:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/final-app-8c21fa647f7504e79adc70e36ea2e802.gif"},9287:(e,n,t)=>{t.d(n,{A:()=>a});const a="data:image/png;base64,dmVyc2lvbiBodHRwczovL2dpdC1sZnMuZ2l0aHViLmNvbS9zcGVjL3YxCm9pZCBzaGEyNTY6YmEyYWNmYjlkNGEyMDE0MTE0ZTQ0ZjU4ZTBlMzk0MjI4MmIzMjcwNWM1ZjRkZTNhZGUxM2Y3ZjQzN2E3MWE1ZQpzaXplIDEzMTkxOAo="}}]);